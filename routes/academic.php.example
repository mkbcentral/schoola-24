<?php

/**
 * Routes du Domaine Académique
 *
 * Gestion des étudiants, inscriptions et frais scolaires
 */

use App\Livewire\Application\Fee\Scolar\MainScolarFeePage;
use App\Livewire\Application\Registration\List\ListRegistrationByClassRoomPage;
use App\Livewire\Application\Registration\List\ListRegistrationByDatePage;
use App\Livewire\Application\Registration\List\ListRegistrationByMonthPage;
use App\Livewire\Application\Student\DetailStudentPage;
use App\Livewire\Application\Student\StudentInfoPage;
use App\Livewire\Application\V2\Fee\FeeManagementPage;
use App\Livewire\Application\V2\Registration\RegistrationListPage;
use App\Livewire\Application\V2\Report\ListStudentDebtPage;
use Illuminate\Support\Facades\Route;

/**
 * Toutes les routes académiques nécessitent authentification
 */
Route::middleware(['auth', 'verified'])->group(function () {

    // ============================================================
    // ÉTUDIANTS
    // ============================================================
    Route::prefix('student')->name('student.')->group(function () {

        Route::get('infos', StudentInfoPage::class)
            ->name('info')
            ->lazy();

        Route::get('{registration}', DetailStudentPage::class)
            ->name('detail')
            ->lazy();

        Route::get('debt/list', ListStudentDebtPage::class)
            ->name('debt.list')
            ->lazy();
    });

    // ============================================================
    // INSCRIPTIONS
    // ============================================================
    Route::prefix('registration')->name('registration.')->group(function () {

        // Listes par critères
        Route::get('by-date/{isOld}/{dateFilter}', ListRegistrationByDatePage::class)
            ->name('date')
            ->lazy();

        Route::get('by-month/{isOld}/{monthFilter}', ListRegistrationByMonthPage::class)
            ->name('month')
            ->lazy();

        Route::get('by-class-room/{classRoomId}', ListRegistrationByClassRoomPage::class)
            ->name('by.class-room')
            ->lazy();

        // Version 2 (nouvelle architecture)
        Route::get('v2', RegistrationListPage::class)
            ->name('v2.index')
            ->lazy();
    });

    // ============================================================
    // FRAIS SCOLAIRES
    // ============================================================
    Route::prefix('fee')->name('fee.')->group(function () {

        Route::get('scolar', MainScolarFeePage::class)
            ->name('scolar')
            ->lazy();

        Route::get('manage/v2', FeeManagementPage::class)
            ->name('manage')
            ->lazy();
    });
});
